{
  "info": {
    "name": "Eval API - V1 vs V2 Performance Comparison",
    "_postman_id": "eval-v1-v2-comparison",
    "description": "Collection complÃ¨te pour tester les endpoints V1 (non optimisÃ©) vs V2 (optimisÃ©)\n\n## DiffÃ©rences clÃ©s:\n\n**V1 (Non optimisÃ©)**\n- ProblÃ¨me N+1 (200+ requÃªtes SQL)\n- Boucles multiples sur les mÃªmes donnÃ©es\n- Bubble sort O(nÂ²)\n- Pas de cache\n- Chargement complet en mÃ©moire\n- Sleeps artificiels\n\n**V2 (OptimisÃ©)**\n- JOINs SQL (5 requÃªtes)\n- AgrÃ©gations SQL (GROUP BY, SUM, COUNT)\n- Tri en SQL (ORDER BY)\n- Cache applicatif (5 min TTL)\n- Streaming par batches\n- Pas de sleeps\n\n## DonnÃ©es:\n- ~110 000 commandes\n- ~330 000 lignes de ventes\n- 5 ans de donnÃ©es",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:8080",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Health Check",
      "item": [
        {
          "name": "Health",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/health",
              "host": ["{{baseUrl}}"],
              "path": ["api", "health"]
            },
            "description": "VÃ©rifie que l'API est opÃ©rationnelle"
          },
          "response": []
        }
      ]
    },
    {
      "name": "V1 - Non OptimisÃ©",
      "item": [
        {
          "name": "Stats 365 jours",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/stats?days=365",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "stats"],
              "query": [
                {
                  "key": "days",
                  "value": "365",
                  "description": "Nombre de jours Ã  analyser"
                }
              ]
            },
            "description": "**âš ï¸ VERSION NON OPTIMISÃ‰E**\n\nProblÃ¨mes:\n- âŒ N+1 problem (200+ requÃªtes SQL)\n- âŒ Boucles multiples sur les mÃªmes donnÃ©es\n- âŒ Bubble sort O(nÂ²) pour trier les produits\n- âŒ Sleeps artificiels (30ms par catÃ©gorie + 10ms/100 items)\n- âŒ Pas de cache\n\nPerformance attendue:\n- Temps: 10-15 secondes\n- RequÃªtes SQL: ~200\n- MÃ©moire: ~60 MB"
          },
          "response": []
        },
        {
          "name": "Stats 30 jours",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/stats?days=30",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "stats"],
              "query": [
                {
                  "key": "days",
                  "value": "30"
                }
              ]
            },
            "description": "Stats sur 30 jours (plus rapide que 365 mais toujours les mÃªmes anti-patterns)"
          },
          "response": []
        },
        {
          "name": "Stats 7 jours",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/stats?days=7",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "stats"],
              "query": [
                {
                  "key": "days",
                  "value": "7"
                }
              ]
            },
            "description": "Stats sur 7 jours (volume minimal mais anti-patterns toujours prÃ©sents)"
          },
          "response": []
        },
        {
          "name": "Export CSV",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/export/csv?days=365",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "export", "csv"],
              "query": [
                {
                  "key": "days",
                  "value": "365"
                }
              ]
            },
            "description": "**âš ï¸ EXPORT CSV NON OPTIMISÃ‰**\n\nProblÃ¨mes:\n- âŒ N+1: RequÃªte individuelle pour CHAQUE produit\n- âŒ Sleep tous les 1000 items\n- âŒ Sleep final de 2 secondes\n\nPerformance:\n- Temps: 20-40 secondes\n- Fichier: ~330 000 lignes"
          },
          "response": []
        },
        {
          "name": "Export Stats CSV",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/export/stats-csv?days=365",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "export", "stats-csv"],
              "query": [
                {
                  "key": "days",
                  "value": "365"
                }
              ]
            },
            "description": "**âš ï¸ EXPORT STATS CSV NON OPTIMISÃ‰**\n\nProblÃ¨mes:\n- âŒ Recalcule TOUT (pas de cache)\n- âŒ N+1 problem\n- âŒ Sleep de 1 seconde\n\nRetourne un CSV avec:\n- Stats globales\n- Stats par catÃ©gorie\n- Top 10 produits"
          },
          "response": []
        },
        {
          "name": "Export Parquet",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v1/export/parquet?days=365",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v1", "export", "parquet"],
              "query": [
                {
                  "key": "days",
                  "value": "365"
                }
              ]
            },
            "description": "**âš ï¸ EXPORT PARQUET NON OPTIMISÃ‰**\n\nProblÃ¨mes MAJEURS:\n- âŒ Charge TOUTES les donnÃ©es en mÃ©moire (2-5 GB !)\n- âŒ N+1 pour rÃ©cupÃ©rer produits, clients, magasins\n- âŒ Sleep tous les 100 items\n- âŒ Sleep final de 2 secondes\n- âš ï¸ Peut crasher si trop de donnÃ©es\n\nPerformance:\n- Temps: 30-60 secondes\n- MÃ©moire: 2-5 GB\n- ScalabilitÃ©: âŒ Crash >500k lignes"
          },
          "response": []
        }
      ],
      "description": "Endpoints V1 dÃ©montrant les **anti-patterns** et le code non optimisÃ©"
    },
    {
      "name": "V2 - OptimisÃ©",
      "item": [
        {
          "name": "Stats 365 jours",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v2/stats?days=365",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v2", "stats"],
              "query": [
                {
                  "key": "days",
                  "value": "365"
                }
              ]
            },
            "description": "**âœ… VERSION OPTIMISÃ‰E**\n\nOptimisations:\n- âœ… JOINs SQL (5 requÃªtes au lieu de 200+)\n- âœ… AgrÃ©gations SQL (GROUP BY, SUM, COUNT)\n- âœ… Tri en SQL (ORDER BY)\n- âœ… Cache applicatif (5 min TTL)\n- âœ… PrÃ©allocation de slices\n- âœ… Pas de sleeps\n\nPerformance:\n- Temps: 1-2 secondes (1Ã¨re fois)\n- Temps: < 5 ms (avec cache)\n- RequÃªtes SQL: 5\n- MÃ©moire: ~5 MB\n\n**AmÃ©lioration: 80-90% plus rapide que V1**\n\nBonus V2:\n- Top 5 magasins\n- RÃ©partition par mÃ©thode de paiement\n- Nombre de commandes (distinct orders)"
          },
          "response": []
        },
        {
          "name": "Stats 365 jours (2Ã¨me appel - CACHE)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v2/stats?days=365",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v2", "stats"],
              "query": [
                {
                  "key": "days",
                  "value": "365"
                }
              ]
            },
            "description": "**âœ… AVEC CACHE**\n\nSi appelÃ© dans les 5 minutes suivant le 1er appel:\n- âš¡ Temps: < 5 ms\n- ðŸš€ Pas de requÃªte SQL\n- ðŸ’¾ RÃ©ponse depuis la mÃ©moire\n\n**AmÃ©lioration: 99.9% plus rapide que V1**"
          },
          "response": []
        },
        {
          "name": "Stats 30 jours",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v2/stats?days=30",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v2", "stats"],
              "query": [
                {
                  "key": "days",
                  "value": "30"
                }
              ]
            },
            "description": "Stats optimisÃ©es sur 30 jours"
          },
          "response": []
        },
        {
          "name": "Stats 7 jours",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v2/stats?days=7",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v2", "stats"],
              "query": [
                {
                  "key": "days",
                  "value": "7"
                }
              ]
            },
            "description": "Stats optimisÃ©es sur 7 jours"
          },
          "response": []
        },
        {
          "name": "Export CSV",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v2/export/csv?days=365",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v2", "export", "csv"],
              "query": [
                {
                  "key": "days",
                  "value": "365"
                }
              ]
            },
            "description": "**âœ… EXPORT CSV OPTIMISÃ‰**\n\nOptimisations:\n- âœ… UNE seule requÃªte avec tous les JOINs\n- âœ… Pas de N+1\n- âœ… Buffer prÃ©allouÃ© (1 MB)\n- âœ… Pas de sleeps\n\nPerformance:\n- Temps: 3-8 secondes\n- Fichier: ~330 000 lignes\n\n**AmÃ©lioration: 75-85% plus rapide que V1**\n\nColonnes additionnelles vs V1:\n- Nom du client complet\n- Nom du magasin + ville"
          },
          "response": []
        },
        {
          "name": "Export Stats CSV",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v2/export/stats-csv?days=365",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v2", "export", "stats-csv"],
              "query": [
                {
                  "key": "days",
                  "value": "365"
                }
              ]
            },
            "description": "**âœ… EXPORT STATS CSV OPTIMISÃ‰**\n\nOptimisations:\n- âœ… Utilise le cache si disponible\n- âœ… Pas de sleeps\n\nRetourne un CSV avec:\n- Stats globales (+ nombre de commandes)\n- Stats par catÃ©gorie\n- Top 10 produits\n- **Bonus:** Top 5 magasins\n- **Bonus:** RÃ©partition paiements"
          },
          "response": []
        },
        {
          "name": "Export Parquet",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{baseUrl}}/api/v2/export/parquet?days=365",
              "host": ["{{baseUrl}}"],
              "path": ["api", "v2", "export", "parquet"],
              "query": [
                {
                  "key": "days",
                  "value": "365"
                }
              ]
            },
            "description": "**âœ… EXPORT PARQUET OPTIMISÃ‰**\n\nOptimisations MAJEURES:\n- âœ… UNE seule requÃªte avec tous les JOINs\n- âœ… **Streaming par batches de 1000** lignes\n- âœ… MÃ©moire constante (~0.2 MB)\n- âœ… Pas de sleeps\n- âœ… Scalable Ã  l'infini\n\nPerformance:\n- Temps: 5-10 secondes\n- MÃ©moire: ~0.2 MB (max batch)\n- ScalabilitÃ©: âœ… Millions de lignes OK\n\n**AmÃ©lioration:**\n- 80% plus rapide\n- 99.99% moins de mÃ©moire (0.2 MB vs 5 GB)\n- ScalabilitÃ© infinie"
          },
          "response": []
        }
      ],
      "description": "Endpoints V2 dÃ©montrant les **best practices** et le code optimisÃ©"
    },
    {
      "name": "Tests de Comparaison",
      "item": [
        {
          "name": "Comparaison Stats - V1 vs V2",
          "item": [
            {
              "name": "1. V1 Stats (Non optimisÃ©)",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/api/v1/stats?days=365",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "v1", "stats"],
                  "query": [{"key": "days", "value": "365"}]
                }
              },
              "response": []
            },
            {
              "name": "2. V2 Stats (OptimisÃ©)",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/api/v2/stats?days=365",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "v2", "stats"],
                  "query": [{"key": "days", "value": "365"}]
                }
              },
              "response": []
            },
            {
              "name": "3. V2 Stats (Cache)",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/api/v2/stats?days=365",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "v2", "stats"],
                  "query": [{"key": "days", "value": "365"}]
                }
              },
              "response": []
            }
          ],
          "description": "ExÃ©cuter dans l'ordre pour comparer:\n1. V1: 10-15 secondes\n2. V2: 1-2 secondes\n3. V2 cache: < 5 ms"
        },
        {
          "name": "Comparaison Export CSV - V1 vs V2",
          "item": [
            {
              "name": "1. V1 Export CSV (Non optimisÃ©)",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/api/v1/export/csv?days=30",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "v1", "export", "csv"],
                  "query": [{"key": "days", "value": "30"}]
                }
              },
              "response": []
            },
            {
              "name": "2. V2 Export CSV (OptimisÃ©)",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/api/v2/export/csv?days=30",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "v2", "export", "csv"],
                  "query": [{"key": "days", "value": "30"}]
                }
              },
              "response": []
            }
          ],
          "description": "Utilise days=30 pour exports plus rapides lors des tests"
        },
        {
          "name": "Comparaison Parquet - V1 vs V2",
          "item": [
            {
              "name": "1. V1 Export Parquet (âš ï¸ MÃ©moire intensive)",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/api/v1/export/parquet?days=30",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "v1", "export", "parquet"],
                  "query": [{"key": "days", "value": "30"}]
                }
              },
              "response": []
            },
            {
              "name": "2. V2 Export Parquet (Streaming)",
              "request": {
                "method": "GET",
                "header": [],
                "url": {
                  "raw": "{{baseUrl}}/api/v2/export/parquet?days=365",
                  "host": ["{{baseUrl}}"],
                  "path": ["api", "v2", "export", "parquet"],
                  "query": [{"key": "days", "value": "365"}]
                }
              },
              "response": []
            }
          ],
          "description": "âš ï¸ V1 avec days=30 seulement (mÃ©moire)\nV2 peut gÃ©rer days=365 sans problÃ¨me"
        }
      ],
      "description": "SÃ©quences de tests pour comparer V1 vs V2 cÃ´te Ã  cÃ´te"
    }
  ]
}
