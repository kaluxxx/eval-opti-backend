{
	"info": {
		"_postman_id": "eval-api-collection",
		"name": "API Ventes - V1 vs V2",
		"description": "Collection pour tester et comparer les APIs V1 (non optimisée) et V2 (optimisée)",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Health Check",
			"item": [
				{
					"name": "Health",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost:8080/api/health",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "8080",
							"path": [
								"api",
								"health"
							]
						},
						"description": "Vérifie l'état du serveur"
					},
					"response": []
				}
			]
		},
		{
			"name": "API V1 - Non Optimisée",
			"item": [
				{
					"name": "Stats JSON - 10 jours",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost:8080/api/v1/stats?days=10",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "8080",
							"path": [
								"api",
								"v1",
								"stats"
							],
							"query": [
								{
									"key": "days",
									"value": "10",
									"description": "Nombre de jours de données"
								}
							]
						},
						"description": "Récupère les statistiques JSON (V1 non optimisée) - Test rapide"
					},
					"response": []
				},
				{
					"name": "Stats JSON - 365 jours",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost:8080/api/v1/stats?days=365",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "8080",
							"path": [
								"api",
								"v1",
								"stats"
							],
							"query": [
								{
									"key": "days",
									"value": "365",
									"description": "Nombre de jours de données"
								}
							]
						},
						"description": "Récupère les statistiques JSON (V1 non optimisée) - LENT (~5-7s)"
					},
					"response": []
				},
				{
					"name": "Export CSV - 10 jours",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost:8080/api/v1/export/csv?days=10",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "8080",
							"path": [
								"api",
								"v1",
								"export",
								"csv"
							],
							"query": [
								{
									"key": "days",
									"value": "10"
								}
							]
						},
						"description": "Export CSV complet des ventes (V1) - Test rapide"
					},
					"response": []
				},
				{
					"name": "Export CSV - 365 jours",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost:8080/api/v1/export/csv?days=365",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "8080",
							"path": [
								"api",
								"v1",
								"export",
								"csv"
							],
							"query": [
								{
									"key": "days",
									"value": "365"
								}
							]
						},
						"description": "Export CSV complet des ventes (V1) - TRÈS LENT (~10-15s)"
					},
					"response": []
				},
				{
					"name": "Export Stats CSV - 365 jours",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost:8080/api/v1/export/stats-csv?days=365",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "8080",
							"path": [
								"api",
								"v1",
								"export",
								"stats-csv"
							],
							"query": [
								{
									"key": "days",
									"value": "365"
								}
							]
						},
						"description": "Export CSV des statistiques agrégées (V1) - LENT (~7-10s)"
					},
					"response": []
				}
			],
			"description": "Endpoints V1 avec code non optimisé (génération à chaque requête, bubble sort, sleeps artificiels)"
		},
		{
			"name": "API V2 - Optimisée",
			"item": [
				{
					"name": "Stats JSON - 10 jours (1ère fois)",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost:8080/api/v2/stats?days=10",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "8080",
							"path": [
								"api",
								"v2",
								"stats"
							],
							"query": [
								{
									"key": "days",
									"value": "10"
								}
							]
						},
						"description": "Récupère les statistiques JSON (V2 optimisée) - Génère le cache"
					},
					"response": []
				},
				{
					"name": "Stats JSON - 10 jours (avec cache)",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost:8080/api/v2/stats?days=10",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "8080",
							"path": [
								"api",
								"v2",
								"stats"
							],
							"query": [
								{
									"key": "days",
									"value": "10"
								}
							]
						},
						"description": "Récupère les statistiques JSON depuis le cache - TRÈS RAPIDE (~5ms)"
					},
					"response": []
				},
				{
					"name": "Stats JSON - 365 jours (1ère fois)",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost:8080/api/v2/stats?days=365",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "8080",
							"path": [
								"api",
								"v2",
								"stats"
							],
							"query": [
								{
									"key": "days",
									"value": "365"
								}
							]
						},
						"description": "Récupère les statistiques JSON (V2) - Génère le cache (~2-3s)"
					},
					"response": []
				},
				{
					"name": "Stats JSON - 365 jours (avec cache)",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost:8080/api/v2/stats?days=365",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "8080",
							"path": [
								"api",
								"v2",
								"stats"
							],
							"query": [
								{
									"key": "days",
									"value": "365"
								}
							]
						},
						"description": "Récupère les statistiques depuis le cache - TRÈS RAPIDE (~5-10ms)"
					},
					"response": []
				},
				{
					"name": "Export CSV - 365 jours",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost:8080/api/v2/export/csv?days=365",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "8080",
							"path": [
								"api",
								"v2",
								"export",
								"csv"
							],
							"query": [
								{
									"key": "days",
									"value": "365"
								}
							]
						},
						"description": "Export CSV complet des ventes (V2 optimisée) - RAPIDE (~3-5s première fois, avec cache après)"
					},
					"response": []
				},
				{
					"name": "Export Stats CSV - 365 jours",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost:8080/api/v2/export/stats-csv?days=365",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "8080",
							"path": [
								"api",
								"v2",
								"export",
								"stats-csv"
							],
							"query": [
								{
									"key": "days",
									"value": "365"
								}
							]
						},
						"description": "Export CSV des statistiques (V2 optimisée) - TRÈS RAPIDE (~3-5ms avec cache)"
					},
					"response": []
				}
			],
			"description": "Endpoints V2 avec optimisations (cache, tri efficace, calculs optimisés, pas de sleeps)"
		},
		{
			"name": "Profiling",
			"item": [
				{
					"name": "Pprof Index",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost:8080/debug/pprof/",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "8080",
							"path": [
								"debug",
								"pprof",
								""
							]
						},
						"description": "Page d'index du profiler pprof"
					},
					"response": []
				},
				{
					"name": "CPU Profile (30s)",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost:8080/debug/pprof/profile?seconds=30",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "8080",
							"path": [
								"debug",
								"pprof",
								"profile"
							],
							"query": [
								{
									"key": "seconds",
									"value": "30"
								}
							]
						},
						"description": "Profile CPU pendant 30 secondes (à analyser avec go tool pprof)"
					},
					"response": []
				},
				{
					"name": "Memory Profile",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost:8080/debug/pprof/heap",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "8080",
							"path": [
								"debug",
								"pprof",
								"heap"
							]
						},
						"description": "Profile mémoire heap"
					},
					"response": []
				},
				{
					"name": "Goroutines",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "http://localhost:8080/debug/pprof/goroutine",
							"protocol": "http",
							"host": [
								"localhost"
							],
							"port": "8080",
							"path": [
								"debug",
								"pprof",
								"goroutine"
							]
						},
						"description": "Informations sur les goroutines"
					},
					"response": []
				}
			],
			"description": "Endpoints pour le profiling avec pprof"
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// Test automatique pour mesurer le temps de réponse",
					"pm.test(\"Response time is less than 20000ms\", function () {",
					"    pm.expect(pm.response.responseTime).to.be.below(20000);",
					"});",
					"",
					"pm.test(\"Status code is 200\", function () {",
					"    pm.response.to.have.status(200);",
					"});",
					"",
					"// Affiche le temps de réponse dans la console",
					"console.log(\"Temps de réponse: \" + pm.response.responseTime + \"ms\");"
				]
			}
		}
	],
	"variable": [
		{
			"key": "baseUrl",
			"value": "http://localhost:8080",
			"type": "string"
		}
	]
}
